<!-- <!DOCTYPE html> -->
<html>
	<head>
		<title>The Network of Wars</title>
	 <!-- subtitle: Network Analysis Between Countries at War  -->
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<style>

		@media (max-width:660px){
	      #profile_photo {
						display: none;
	      }
			}

		@media (min-width:660px){
			#hidden_project_explained {
				display: none;
	    }
	  }

		svg {
			border: 1px solid #000;
		}

		.link line {
		  stroke: #696969;
		}

		.link line.separator {
		  stroke: #fff;
		  stroke-width: 2px;
		}

		.node circle {
		  stroke: #000;
		  stroke-width: 1.5px;
		}

		.node text {
		  font: 10px sans-serif;
		  pointer-events: none;
			-webkit-touch-callout: none;
			-webkit-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
		}



		</style>
	</head>
	<body>
		<!-- Load d3.js -->
		<!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->

		<script src="//d3js.org/d3.v3.min.js"></script>
		<div id="hidden_project_explained" align="left" style="margin-bottom:150px;">
			<p>While I'm flattered you came to check out my project, it has several interactive features that work best on desktop. So, grab a computer and come back soon!</p>
		</div>
		<div class="message">
		  <p>Hey there! This project is currently in progress. Stay tuned soon for more updates.</p>
		</div>
		<!-- Create a div where the graph will take place -->
		<div id="war_network_analysis" align="center"></div>
		<script>

		d3.json("../assets/network_of_wars/network_of_wars.json", function(error, graph) {
		  if (error) throw error;

			var color = d3.scale.linear().domain([1,2]).range(["lightgreen", "violet"])
					maxRadius = 40,
					radius = d3.scale.linear()
														.domain([0, d3.max(graph.nodes, function(d) { return d.size ; })])
														.range([2.5, maxRadius]);
			// set the dimensions and margins of the graph
			var margin = {top: 0, bottom: 15, left: 0, right: 0},
			    width = 800,
			    height = 450;

			// append the svg object to the body of the page
			var svg = d3.select("#war_network_analysis")
					.append("svg")
					  .attr("width", width)
					  .attr("height", height)
						// .append("g")
					  .attr("transform",
					        "translate(" + margin.left + "," + margin.top + ")");

			var force = d3.layout.force()
			    .size([width, height])
			    .charge(-500)
					// .friction(0.75)
					.gravity(0.075)
					.linkStrength(0.1)
			    .linkDistance(function(d) { return radius(d.source.size) + radius(d.target.size) + 30; });
					// .linkDistance(height/3);
		  force
		      .nodes(graph.nodes)
		      .links(graph.links)
		      .on("tick", tick)
		      .start();

		  var link = svg.selectAll(".link")
		      .data(graph.links)
		    	.enter().append("g")
		      	.attr("class", "link");

		  link.append("line")
		      .style("stroke-width", function(d) { return (d.lines * 2 - 1) * 2 + "px"; });

		  link.filter(function(d) { return d.lines > 1; })
					.append("line")
		      .attr("class", "separator");

		  var node = svg.selectAll(".node")
		      .data(graph.nodes)
		    .enter().append("g")
		      .attr("class", "node")
		      .call(force.drag);

		  node.append("circle")
		      .attr("r", function(d) { return radius(d.size); })
					// .attr("opacity", 0.75)
		      .style("fill", function(d) { return color(d.side); });

		  node.append("text")
					.attr("class", "country_text")
		      .attr("dy", "0.35em")
		      .attr("text-anchor", "middle")
					// .attr("alignment-baseline", "hanging")
		      .text(function(d) { return d.country; })
					.attr("pointer-events", "none");

		  function tick() {

		    svg.selectAll(".node")
						.attr("transform", function(d) { return "translate(" + Math.max(radius(d.size) + 5, Math.min(width - radius(d.size) - 5, d.x)) + "," + Math.max(radius(d.size) + 5, Math.min(height - radius(d.size) - 5, d.y)) + ")"; })

		    link.selectAll("line")
						.attr("x1", function(d) { return d.source.x; })
		        .attr("y1", function(d) { return d.source.y; })
		        .attr("x2", function(d) { return d.target.x; })
		        .attr("y2", function(d) { return d.target.y; });
		  }
		});

		//
		// d3.json("../assets/network_of_wars/network_of_wars.json", function(error, graph) {
		//
		//
		// var margin = {top: 0, bottom: 15, left: 0, right: 0},
		//     width = 800,
		//     height = 450;
		//
		// // append the svg object to the body of the page
		// var svg = d3.select("#war_network_analysis")
		// 		.append("svg")
		// 		  .attr("width", width)
		// 		  .attr("height", height)
		// 			// .append("g")
		// 		  .attr("transform",
		// 		        "translate(" + margin.left + "," + margin.top + ")");
		//
		// var color = d3.scale.category20(),
		// 		maxRadius = 50,
		// 		radius = d3.scale.linear()
		// 												.domain([0, d3.max(graph.nodes, function(d) { return d.size ; })])
		// 												.range([2.5, maxRadius]);
		//
		// 	var force = d3.layout.force()
		// 	    .charge(-500)
		// 	    .linkDistance(function(d) { return radius(d.source.size) + radius(d.target.size) + 30; })
		// 	    .size([width, height]);
		//
		//   var linkNodes = [];
		//
		//   graph.links.forEach(function(link) {
		//     linkNodes.push({
		//       source: graph.nodes[link.source],
		//       target: graph.nodes[link.target]
		//     });
		//   });
		//
		//   force
		//       .nodes(graph.nodes.concat(linkNodes))
		//       .links(graph.links)
		//       .start();
		//
		//   var link = svg.selectAll(".link")
		//       .data(graph.links)
		//     .enter().append("line")
		//       .attr("class", "link")
		//       .style("stroke-width", function(d) { return Math.sqrt(d.bond); });
		//
		//   var node = svg.selectAll(".node")
		//       .data(graph.nodes)
		//     .enter().append("circle")
		//       .attr("class", "node")
    //       .attr("r", function(d) { return radius(d.size); })
		//       .style("fill", "red")
		//       .call(force.drag);
		//
		//   node.append("title")
		//       .text(function(d) { return d.country; });
		//
		//   var linkNode = svg.selectAll(".link-node")
		//       .data(linkNodes)
		//     .enter().append("circle")
		//       .attr("class", "link-node")
		//       .attr("r", function(d) { return radius(d.size); })
		//       .style("fill", "#ccc");
		//
		//   force.on("tick", function() {
		//     link.attr("x1", function(d) { return d.source.x; })
		//         .attr("y1", function(d) { return d.source.y; })
		//         .attr("x2", function(d) { return d.target.x; })
		//         .attr("y2", function(d) { return d.target.y; });
		//
		//     node.attr("cx", function(d) { return d.x; })
		//         .attr("cy", function(d) { return d.y; });
		//
		//     linkNode.attr("cx", function(d) { return d.x = (d.source.x + d.target.x) * 0.5; })
		//         .attr("cy", function(d) { return d.y = (d.source.y + d.target.y) * 0.5; });
		//   });
		// });

		</script>
	</body>
</html>
